(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[0],{

/***/ "../pkg/genby.js":
/*!***********************!*\
  !*** ../pkg/genby.js ***!
  \***********************/
/*! exports provided: create, tick, size, get_pixels, get_heights, get_wind_directions, alter_world, __wbg_random_2cc0c8d054a5c72a, __wbindgen_throw */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"create\", function() { return create; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"tick\", function() { return tick; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"size\", function() { return size; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_pixels\", function() { return get_pixels; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_heights\", function() { return get_heights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_wind_directions\", function() { return get_wind_directions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"alter_world\", function() { return alter_world; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_random_2cc0c8d054a5c72a\", function() { return __wbg_random_2cc0c8d054a5c72a; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_throw\", function() { return __wbindgen_throw; });\n/* harmony import */ var _genby_bg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./genby_bg */ \"../pkg/genby_bg.wasm\");\n/* tslint:disable */\n\n\n/**\n* @param {number} arg0\n* @param {number} arg1\n* @returns {void}\n*/\nfunction create(arg0, arg1) {\n    return _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"create\"](arg0, arg1);\n}\n\n/**\n* @param {number} arg0\n* @returns {void}\n*/\nfunction tick(arg0) {\n    return _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"tick\"](arg0);\n}\n\nlet cachegetUint32Memory = null;\nfunction getUint32Memory() {\n    if (cachegetUint32Memory === null || cachegetUint32Memory.buffer !== _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer) {\n        cachegetUint32Memory = new Uint32Array(_genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer);\n    }\n    return cachegetUint32Memory;\n}\n\nfunction getArrayU32FromWasm(ptr, len) {\n    return getUint32Memory().subarray(ptr / 4, ptr / 4 + len);\n}\n\nlet cachedGlobalArgumentPtr = null;\nfunction globalArgumentPtr() {\n    if (cachedGlobalArgumentPtr === null) {\n        cachedGlobalArgumentPtr = _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_global_argument_ptr\"]();\n    }\n    return cachedGlobalArgumentPtr;\n}\n/**\n* @returns {Uint32Array}\n*/\nfunction size() {\n    const retptr = globalArgumentPtr();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"size\"](retptr);\n    const mem = getUint32Memory();\n    const rustptr = mem[retptr / 4];\n    const rustlen = mem[retptr / 4 + 1];\n\n    const realRet = getArrayU32FromWasm(rustptr, rustlen).slice();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_free\"](rustptr, rustlen * 4);\n    return realRet;\n\n}\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer) {\n        cachegetUint8Memory = new Uint8Array(_genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nfunction getArrayU8FromWasm(ptr, len) {\n    return getUint8Memory().subarray(ptr / 1, ptr / 1 + len);\n}\n/**\n* @param {boolean} arg0\n* @param {boolean} arg1\n* @param {boolean} arg2\n* @param {boolean} arg3\n* @returns {Uint8Array}\n*/\nfunction get_pixels(arg0, arg1, arg2, arg3) {\n    const retptr = globalArgumentPtr();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"get_pixels\"](retptr, arg0, arg1, arg2, arg3);\n    const mem = getUint32Memory();\n    const rustptr = mem[retptr / 4];\n    const rustlen = mem[retptr / 4 + 1];\n\n    const realRet = getArrayU8FromWasm(rustptr, rustlen).slice();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_free\"](rustptr, rustlen * 1);\n    return realRet;\n\n}\n\nlet cachegetFloat32Memory = null;\nfunction getFloat32Memory() {\n    if (cachegetFloat32Memory === null || cachegetFloat32Memory.buffer !== _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer) {\n        cachegetFloat32Memory = new Float32Array(_genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer);\n    }\n    return cachegetFloat32Memory;\n}\n\nfunction getArrayF32FromWasm(ptr, len) {\n    return getFloat32Memory().subarray(ptr / 4, ptr / 4 + len);\n}\n/**\n* @param {boolean} arg0\n* @returns {Float32Array}\n*/\nfunction get_heights(arg0) {\n    const retptr = globalArgumentPtr();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"get_heights\"](retptr, arg0);\n    const mem = getUint32Memory();\n    const rustptr = mem[retptr / 4];\n    const rustlen = mem[retptr / 4 + 1];\n\n    const realRet = getArrayF32FromWasm(rustptr, rustlen).slice();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_free\"](rustptr, rustlen * 4);\n    return realRet;\n\n}\n\n/**\n* @returns {Float32Array}\n*/\nfunction get_wind_directions() {\n    const retptr = globalArgumentPtr();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"get_wind_directions\"](retptr);\n    const mem = getUint32Memory();\n    const rustptr = mem[retptr / 4];\n    const rustlen = mem[retptr / 4 + 1];\n\n    const realRet = getArrayF32FromWasm(rustptr, rustlen).slice();\n    _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_free\"](rustptr, rustlen * 4);\n    return realRet;\n\n}\n\n/**\n* @param {number} arg0\n* @param {number} arg1\n* @param {number} arg2\n* @param {number} arg3\n* @param {number} arg4\n* @param {number} arg5\n* @returns {void}\n*/\nfunction alter_world(arg0, arg1, arg2, arg3, arg4, arg5) {\n    return _genby_bg__WEBPACK_IMPORTED_MODULE_0__[\"alter_world\"](arg0, arg1, arg2, arg3, arg4, arg5);\n}\n\nfunction __wbg_random_2cc0c8d054a5c72a() {\n    return Math.random();\n}\n\nlet cachedTextDecoder = new TextDecoder('utf-8');\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n\nfunction __wbindgen_throw(ptr, len) {\n    throw new Error(getStringFromWasm(ptr, len));\n}\n\n\n\n//# sourceURL=webpack:///../pkg/genby.js?");

/***/ }),

/***/ "../pkg/genby_bg.wasm":
/*!****************************!*\
  !*** ../pkg/genby_bg.wasm ***!
  \****************************/
/*! exports provided: memory, __wbindgen_global_argument_ptr, create, tick, size, get_pixels, get_heights, get_wind_directions, alter_world, __wbindgen_free */
/***/ (function(module, exports, __webpack_require__) {

eval("\"use strict\";\n// Instantiate WebAssembly module\nvar wasmExports = __webpack_require__.w[module.i];\n__webpack_require__.r(exports);\n// export exports from WebAssembly module\nfor(var name in wasmExports) if(name != \"__webpack_init__\") exports[name] = wasmExports[name];\n// exec imports from WebAssembly module (for esm order)\n/* harmony import */ var m0 = __webpack_require__(/*! ./genby */ \"../pkg/genby.js\");\n\n\n// exec wasm module\nwasmExports[\"__webpack_init__\"]()\n\n//# sourceURL=webpack:///../pkg/genby_bg.wasm?");

/***/ }),

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var genby__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! genby */ \"../pkg/genby.js\");\n/* harmony import */ var _simulationConfig__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./simulationConfig */ \"./simulationConfig.js\");\n\n\n\nconst canvas = document.getElementById(\"canvas\");\n\ngenby__WEBPACK_IMPORTED_MODULE_0__[\"create\"]();\nconst worldSize = genby__WEBPACK_IMPORTED_MODULE_0__[\"size\"]()\n\ncanvas.width = _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].cellSize * worldSize[0];\ncanvas.height = _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].cellSize * worldSize[1];\n\nconst gl = canvas.getContext(\"webgl\");\n\nconst shaders = new Shader();\nshaders.init(gl);\nconst scene = new Scene(canvas, gl, shaders);\nconst va = new VertexArray(gl, shaders);\nscene.vas.push(va);\n\nscene.camera.cameraTranslation = [-worldSize[0] / 2.0,-100,-worldSize[1]];\nscene.camera.direction = [0, -2, -1];\nscene.camera.zFar = 300;\n\n\nObject(_simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"bindBrush\"])(canvas, genby__WEBPACK_IMPORTED_MODULE_0__[\"alter_world\"]);\n\nconst pushVertex = (pixels, heights, i, x, y, normal) => {\n  const r = pixels[3*i]/255;\n  const g = pixels[3*i+1]/255;\n  const b = pixels[3*i+2]/255;\n  const height = heights[i];\n  va.makeVertex([x , height * 10,y], [r, g, b], normal);\n}\n\nconst generateSquare = (pixels, heights, x, y, top) => {\n  const x1 = x + 1;\n  const y1 = top ? y+1 : y;\n  const x2 = top ? x : x+1;\n  const y2 = y + 1;\n  \n  const normal = vec3.normalize(vec3.create(), vec3.cross(\n        vec3.create(),\n        vec3.sub(vec3.create(), [x2, heights[y2 * worldSize[0] + x2] * 10, y2], [x, heights[y * worldSize[0] + x] * 10, y]),\n        vec3.sub(vec3.create(), [x1, heights[y1 * worldSize[0] + x1] * 10, y1], [x, heights[y * worldSize[0] + x] * 10, y]),\n      ));\n\n  pushVertex(pixels, heights, y * worldSize[0] + x, x, y, normal);\n  pushVertex(pixels, heights, y1 * worldSize[0] + x1, x1, y1, normal);\n  pushVertex(pixels, heights, y2 * worldSize[0] + x2, x2, y2, normal);\n\n}\n\nconst generateVa = (pixels, heights) => {\n  va.vertexArray = [];\n  for (let x = 0; x < worldSize[0] - 1; x++) {\n    for (let y = 0; y < worldSize[1] - 1; y++) {\n      generateSquare(pixels, heights, x, y, true);\n      generateSquare(pixels, heights, x, y, false);\n    }\n  }\n}\n\nconst drawWorld = pixels => {\n  scene.update();\n\n  scene.draw(gl, shaders);\n};\n\nconst drawWind = winds => {\n}\n\nconst loop = () => {\n  genby__WEBPACK_IMPORTED_MODULE_0__[\"tick\"](0.25);\n  generateVa(genby__WEBPACK_IMPORTED_MODULE_0__[\"get_pixels\"](_simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawHeight, _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawWater, _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawAirPressure, _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawBiomes), genby__WEBPACK_IMPORTED_MODULE_0__[\"get_heights\"](_simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawWater));\n  drawWorld(genby__WEBPACK_IMPORTED_MODULE_0__[\"get_pixels\"](_simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawHeight, _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawWater, _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawAirPressure, _simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawBiomes));\n  if (_simulationConfig__WEBPACK_IMPORTED_MODULE_1__[\"config\"].drawWind)\n    drawWind(genby__WEBPACK_IMPORTED_MODULE_0__[\"get_wind_directions\"]());\n  requestAnimationFrame(loop);\n};\n\nloop();\n\n\n//# sourceURL=webpack:///./index.js?");

/***/ }),

/***/ "./simulationConfig.js":
/*!*****************************!*\
  !*** ./simulationConfig.js ***!
  \*****************************/
/*! exports provided: config, bindBrush, bindCheckbox, bindInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"config\", function() { return config; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindBrush\", function() { return bindBrush; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindCheckbox\", function() { return bindCheckbox; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bindInput\", function() { return bindInput; });\nconst config = {\n  drawHeight: false,\n  drawWater: false,\n  drawWind: false,\n  drawAirPressure: false,\n  drawBiomes: false,\n  cellSize: 5,\n  brush: {\n    radius: 15,\n    diffWater: 0,\n    diffAirPressure: 0,\n    diffHeight: 0\n  }\n};\n\nconst bindBrush = (canvas, func) => {\n  canvas.addEventListener(\"click\", e => {\n    const x = e.layerX/config.cellSize;\n    const y = e.layerY/config.cellSize;\n    func(x, y, config.brush.radius, config.brush.diffWater, config.brush.diffAirPressure, config.brush.diffHeight);\n  });\n};\n\nconst bindCheckbox = (id, setValue, initialValue) => {\n  const elem = document.getElementById(id);\n  elem.checked = initialValue;\n  elem.addEventListener(\"change\", () => setValue(elem.checked));\n};\n\nconst bindInput = (id, setValue, initialValue) => {\n  const elem = document.getElementById(id);\n  elem.value = initialValue;\n  elem.addEventListener(\"change\", () => setValue(elem.value));\n};\n\nbindCheckbox(\"drawHeight\", value => config.drawHeight = value, config.drawHeight);\nbindCheckbox(\"drawWater\", value => config.drawWater = value, config.drawWater);\nbindCheckbox(\"drawWind\", value => config.drawWind = value, config.drawWind);\nbindCheckbox(\"drawAirPressure\", value => config.drawAirPressure = value, config.drawAirPressure);\nbindCheckbox(\"drawBiomes\", value => config.drawBiomes = value, config.drawBiomes);\n\nbindInput(\"diffWater\", value => config.brush.diffWater = value, config.brush.diffWater);\nbindInput(\"diffAirPressure\", value => config.brush.diffAirPressure = value, config.brush.diffAirPressure);\nbindInput(\"diffHeight\", value => config.brush.diffHeight = value, config.brush.diffHeight);\nbindInput(\"radius\", value => config.brush.radius = value, config.brush.radius);\n\n\n//# sourceURL=webpack:///./simulationConfig.js?");

/***/ })

}]);